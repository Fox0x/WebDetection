let myForm=[{image:"",firstName:"",secondName:""},{image:"",firstName:"",secondName:""},{image:"",firstName:"",secondName:""},{image:"",firstName:"",secondName:""}],minConfidence=.8,options=new faceapi.SsdMobilenetv1Options({minConfidence:minConfidence,maxResults:10}),isPhotoPicked=[!1,!1,!1,!1];async function extractFaceFromBox(e,o){const n=[new faceapi.Rect(o.x-50,o.y-90,o.width+50,o.height+50)];let t=await faceapi.extractFaces(e,n);await addToImageList(t)}let i=1;async function addToImageList(e){await e.forEach(e=>{i<=4?null!==e.toDataURL()&&(isPhotoPicked[i-1]||(document.getElementById("outputImage"+i).src=e.toDataURL()),i++):i=1})}function onClick(e){showForm("form"+e),(isPhotoPicked=[!1,!1,!1,!1])[e-1]=!0,myForm[e-1].image=document.getElementById("outputImage"+e).src,console.log(isPhotoPicked),console.log(myForm[e-1].image)}function showForm(e){document.querySelectorAll("form").forEach(e=>{e.style.visibility="hidden",e.reset()}),document.getElementById(e).style.visibility="visible"}async function onVideoLoaded(){document.getElementById("video").addEventListener("playing",()=>{getDetections(document.getElementById("video"))})}async function getDetections(e){const o=document.getElementById("canvas"),n={width:e.width,height:e.height};faceapi.matchDimensions(o,n),setInterval(async()=>{const t=await faceapi.detectAllFaces(e,options),i=faceapi.resizeResults(t,n);o.getContext("2d").clearRect(0,0,o.width,o.height),i.forEach(n=>{const t="Person "+(i.indexOf(n)+1)+"  sc: "+n.score.toFixed(2).toString();new faceapi.draw.DrawBox(n.box,{label:t}).draw(o),extractFaceFromBox(e,n.box)})},100)}function increaseConfidence(){minConfidence=Math.min(faceapi.utils.round(minConfidence+.1),.9),document.getElementById("confidenceOutput").value=minConfidence,changeModel()}function decreaseConfidence(){minConfidence=Math.max(faceapi.utils.round(minConfidence-.1),.1),document.getElementById("confidenceOutput").value=minConfidence,changeModel()}function changeModel(){let e=document.getElementById("model");options="tinyFaceDetector"===e.value?new faceapi.TinyFaceDetectorOptions({inputSize:160,scoreThreshold:minConfidence}):new faceapi.SsdMobilenetv1Options({minConfidence:minConfidence,maxResults:10}),console.log(options._name)}Promise.all([console.log("Models start loading"),faceapi.loadSsdMobilenetv1Model("..//models"),faceapi.loadTinyFaceDetectorModel("..//models"),console.log("Models are loaded")]).then(()=>{navigator.getUserMedia({video:{}},e=>document.getElementById("video").srcObject=e,e=>console.error(e))}).then(onVideoLoaded);